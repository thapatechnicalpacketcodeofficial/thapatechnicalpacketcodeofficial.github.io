if(!document.completionorangev2){document.completionorangev2=true;function findAbsolutePosition(obj){var curleft=curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent)}return[curleft,curtop]}function completionComponent(divCompletion,field,onSubmitFunction,url,paramName,defaultParams,cssPrefix,selectToHide,idField,left,width,typeComponent){completionComponent.count=completionComponent.count+1;this.divCompletion=divCompletion;this.autoDivCompletion=((typeof divCompletion=="undefined")||divCompletion==null)?true:false;this.number=completionComponent.count;field.setAttribute('autocomplete','off');field.form.setAttribute('autocomplete','off');this.field=field;this._idField=idField;this.url=url;this.paramName=paramName;this.defaultParams=defaultParams;this._selectElementToHide=selectToHide;this.cssPrefix=cssPrefix;this._launchSearch=false;this.minReqSize=1;this._maxNbSuggestions=10;this.defaultValue="";this.defaultMessage="";this.changeOnMouseOver=false;this.changeOnArrowKey=true;this.width=(typeof width!="undefined"?width:"*");this.maxNbChar=0;this.left=left||0;this.historyDisplay=false;this.blocksDisplay=false;this._use2ndColumn=false;this._useDirectLinks=false;this._useId=false;this._directLink="";this.clearAccents=true;this.clearSpecialChars=true;this.specialCharExpr=/[^ a-z0-9\'\-\.]/gi;this.cacheActivated=true;this._cacheSize=20;this._blocnumber=-1;this.blocksTitlesList=new Array();this.blocksConditionList=new Array();this.blocksCountList=new Array();this.field.completeur=this;this._onSubmitFunction=onSubmitFunction;this.blocksCallBackFunctions=new Array();this.changeFormActionWithLink=false;this._resultCache=new Array();this.serviceStatus="";this.typeComponent=typeComponent;if(this.autoDivCompletion){spanAbsPosition=document.createElement('DIV');spanAbsPosition.style.cssText='visibility:visible;position:absolute;text-align:left;';spanAbs2Position=document.createElement('DIV');spanAbs2Position.style.cssText='visibility:visible;position:relative;text-align:left;';spanAbs2Position.appendChild(spanAbsPosition);spanRelPosition=document.createElement('DIV');spanRelPosition.style.cssText='visibility:visible;text-align:left;float:left!important;z-index:800!important;';spanRelPosition.appendChild(spanAbs2Position);field.parentNode.insertBefore(spanRelPosition,field);divBox=document.createElement('DIV');divBox.setAttribute('id',"divCompletion"+this.number);positionChamp=findAbsolutePosition(field);largeur=(this.width=="*")?field.clientWidth:field.clientWidth+this.width;hauteur=0;divBox.className=((this.cssPrefix!='')?this.cssPrefix:"")+"AutoCompleteDivBox";styleBox=false;if(divBox.currentStyle)styleBox=divBox.currentStyle;else if(window.getComputedStyle)styleBox=window.getComputedStyle(divBox,null);if(styleBox){blw=styleBox.borderLeftWidth;brw=styleBox.borderRightWidth;largeur=largeur;btw=styleBox.borderTopWidth;bbw=styleBox.borderBottomWidth;hauteur=hauteur+eval(btw.substring(0,btw.length-2))+eval(bbw.substring(0,bbw.length-2))}if(isNaN(hauteur)){hauteur=0}styleField=false decalageMarge=0;if(divBox.currentStyle)styleField=field.currentStyle;else if(window.getComputedStyle)styleField=window.getComputedStyle(field,null);if(styleField){margeGauche=styleField.marginLeft}divBox.style.cssText='position:absolute;top:'+(field.clientHeight+hauteur)+'px;left:'+(decalageMarge+this.left)+'px;width:'+(largeur)+'px;overflow:hidden;visibility:hidden;background-color:#fff;z-index:1000;text-align:left;';spanAbsPosition.appendChild(divBox);this._completeDiv=divBox}else{this._completeDiv=this.divCompletion;if(typeof(this.cssPrefix)!='undefined'&&this.cssPrefix!=''&&this.cssPrefix!='undefined')this._completeDiv.className=this.cssPrefix+"AutoCompleteDivListeStyle";else this._completeDiv.className="AutoCompleteDivListeStyle"}this.field.onkeydown=function(event){if(typeComponent=="plan"){}else{if(!event&&window.event)event=window.event;if(event){this.completeur._lastKeyCode=event.keyCode;if((this.completeur._lastKeyCode==18)||(this.completeur._lastKeyCode==20))return false}if(this.completeur.handleCursorUpDownEnter(this.completeur._lastKeyCode)&&(this.completeur._lastKeyCode!=0)){this.completeur._suggestionUsed=null;this.completeur.PressAction()}else if(this.completeur._highlightedSuggestionIndex>=0)return false}};this.field.onclick=function(event){searchAddress(event);return false};this.field.onkeyup=function(event){if(!event&&window.event)event=window.event;this.completeur._eventKeycode=event.keyCode;if(this.completeur._eventKeycode==18)return false;if(this.completeur._eventKeycode==27){this.completeur.hideCompleteDiv();return false}if(this.completeur._eventKeycode==40||this.completeur._eventKeycode==38){this.completeur.blurThenGetFocus()}var V=this.completeur.field.value;if(this.completeur._eventKeycode!=0){if(this.completeur._eventKeycode==13||this.completeur._eventKeycode==3){var d=this.completeur.field;if(d.createTextRange){d.createTextRange().moveStart("character",d.value.length);d.select()}else if(d.setSelectionRange){d.setSelectionRange(d.value.length,d.value.length)}blocnumber=this.completeur._blocnumber;checkCallBackFunc=false;if(blocnumber>=0&&typeof this.completeur.blocksCallBackFunctions!='undefined'&&typeof this.completeur.blocksCallBackFunctions[blocnumber]!='undefined'){checkCallBackFunc=true}anchor=this.completeur._directLink;if((!checkCallBackFunc||this.completeur.blocksCallBackFunctions[blocnumber]==null)&&anchor!=null&&typeof anchor!='undefined'&&anchor.length!=0){document.location=anchor;event.cancelBubble=true;return false}if(this.completeur._useHistory==true)updateCookie(V,this.completeur._cookieName);if(this.completeur._launchSearch){if(checkCallBackFunc){if(this.completeur.blocksCallBackFunctions[blocnumber]==null){if(!this.completeur._onSubmitFunction){this.completeur._onSubmitFunction=this.completeur.field.form.submit}}else if(this.completeur.blocksCallBackFunctions[blocnumber]=='none'){this.completeur._onSubmitFunction=this.completeur.field.form.submit}else{this.completeur._onSubmitFunction=this.completeur.blocksCallBackFunctions[blocnumber]}}else if(!this.completeur._onSubmitFunction){this.completeur._onSubmitFunction=this.completeur.field.form.submit}if(this.completeur._onSubmitFunction){if(this.completeur._highlightedSuggestionIndex>=0){if(anchor!=null&&typeof anchor!='undefined'&&anchor.length!=0){if(this.completeur.changeFormActionWithLink){this.completeur.field.form.action=anchor}chaineAppel=this.completeur._onSubmitFunction+'("'+escape(this.completeur.field.value)+'","'+this.completeur._2ndColumnValue+'","'+this.completeur._idValue+'","'+this.completeur.field.id+'","'+anchor+'")'}else{chaineAppel=this.completeur._onSubmitFunction+'("'+escape(this.completeur.field.value)+'","'+this.completeur._2ndColumnValue+'","'+this.completeur._idValue+'","'+this.completeur.field.id+'")'}eval(chaineAppel)}}}this.completeur.hideCompleteDiv();return false}else{if(this.completeur.field.value!=V)this.completeur.field.value=V}}if((this.completeur._eventKeycode!=40)&&(this.completeur._eventKeycode!=38)){this.completeur._cursorUpDownPressed=false;this.completeur._currentInputFieldValue=V}else cursorAfterValue(this.completeur.field);if(this.completeur._oldInputFieldValue!=this.completeur._currentInputFieldValue){var valeur=escape(jstrim(this.completeur._currentInputFieldValue));if(valeur!=''&&valeur.length>=this.completeur.minReqSize&&typeof(valeur)!='undefined'){var suggestions_1=this.completeur._resultCache[this.completeur._currentInputFieldValue.substring(0,this.completeur._currentInputFieldValue.length-1)];if(!suggestions_1||suggestions_1.length!=0){var suggestions=this.completeur._resultCache[this.completeur._currentInputFieldValue];if(suggestions){this.completeur.displayComplete(valeur,suggestions)}else{writeScript(this.completeur.url+'&'+this.completeur.paramName+'='+valeur+'&'+this.completeur.defaultParams)this.completeur.field.focus()}}else{this.completeur._resultCache[this.completeur._currentInputFieldValue]=new Array();if(this.completeur.field.completeur.hideCompleteDiv)this.completeur.field.completeur.hideCompleteDiv()}}else if(this.completeur.field.completeur.hideCompleteDiv)this.completeur.field.completeur.hideCompleteDiv()}this.completeur._oldInputFieldValue=this.completeur._currentInputFieldValue};this.field.fieldonblursav=this.field.getAttribute('onblur');this.field.onblur=function(event){eval(this.completeur.field.fieldonblursav);if(!this.completeur)return false;if(!this.completeur._cursorUpDownPressed){this.completeur.field.completeur.hideCompleteDiv()}this.completeur._cursorUpDownPressed=false}function jstrim(str,charlist){charlist=!charlist?' \\s\\xA0':charlist.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,'\$1');var re=new RegExp('^['+charlist+']+|['+charlist+']+$','g');return str.replace(re,'')}function completionUsed(){return this._suggestionUsed}function cmpl(jsonData){var liste=this.handleJsonSuggestions(jsonData);this.cacheResults(this._currentInputFieldValue,liste);if(liste['serviceStatus']){switch(liste['serviceStatus']){case"SUSPENDED":case"KO_CONFIG":case"KO_PARSE":case"KO_MISC":case"LOCK":removeAutoComplete(this.field);return;break;default:break}}this.displayComplete(this._currentInputFieldValue,liste);if(typeof(liste)!='undefined'&&array_key_exists(1,liste)&&liste.length>0&&liste[1][0]!=''&&this._idField!=null&&document.getElementById(this._idField)){document.getElementById(this._idField).value=liste[1][0]}}function cacheResults(debut,suggestions){if(suggestions['serviceStatus']){switch(suggestions['serviceStatus']){case"TO":case"KO_HTTP":case"KO_CONNECT":return;break;default:break}}if(this._resultCache.length>this._cacheSize)this._resultCache=new Array();if(this.cacheActivated==true)this._resultCache[debut]=suggestions}function setStyleForElement(c,name){if(c!=null){if(typeof(this.cssPrefix)!='undefined'&&this.cssPrefix!=''&&this.cssPrefix!='undefined')c.className=this.cssPrefix+name;else c.className=name}}function handleJsonSuggestions(xmlDoc){var options=xmlDoc[1];var optionsListe=new Array();var optionsCol1=new Array();if((options)&&(options.length)){for(var i=0;(i<options.length)&&(i<this._maxNbSuggestions);++i){opt=options[i];if(this.clearAccents){opt=noAccentCmpl(opt)}if(this.clearSpecialChars){opt=noSpecialCmpl(opt,this.specialCharExpr)}optionsCol1.push(opt)}optionsListe.push(optionsCol1)}if(this._use2ndColumn&&xmlDoc[2]){var optionsCol2=this.handle2ndColumn(xmlDoc[2]);if(optionsCol2!=false)optionsListe.push(optionsCol2)}if(this._useId&&xmlDoc[3]){var optionsCol3=this.handle2ndColumn(xmlDoc[3]);if(optionsCol3!=false)optionsListe.push(optionsCol3)}if(xmlDoc[4]){var optionsCol4=this.handle2ndColumn(xmlDoc[4]);if(optionsCol4!=false)optionsListe['ID']=optionsCol4}if(xmlDoc[5]){var optionsCol5=this.handle2ndColumn(xmlDoc[5]);if(optionsCol5!=false)optionsListe['Link']=optionsCol5}if(xmlDoc[6]){optionsListe['serviceStatus']=xmlDoc[6]}return optionsListe}function displayComplete(valeur,liste){while(this._completeDiv.childNodes.length>0){this._completeDiv.removeChild(this._completeDiv.childNodes[0])}if((liste[0])&&(liste[0].length>0)){if(this._useHistory==true)this.displayHistory();var completeur=this;for(var f=0,compteur=0,num=0;f<liste[0].length;++f,compteur++){var afficher=false;if(liste['ID']&&this.blocksCountList.length>0&&this.blocksConditionList.length>0){var ID=liste['ID'][f];if(compteur>=this.blocksCountList[num]||!eval(this.blocksConditionList[num])){compteur=0;num++;ID=liste['ID'][f]}if(compteur<this.blocksCountList[num]&&eval(this.blocksConditionList[num])){afficher=true}}else{afficher=true}if(afficher&&(this.blocksCountList.length==0||num<=this.blocksCountList.length)){if(compteur==0){var newDiv=document.createElement("SPAN");if(this.blocksTitlesList[num]){newDiv.innerHTML=this.blocksTitlesList[num]}else if(this.blocksCountList.length==0){newDiv.innerHTML='Suggestions'}newDiv.id='completeDivTitle';this.setStyleForElement(newDiv,"AutoCompleteDivTitle");this._completeDiv.appendChild(newDiv)}var newDivLine=document.createElement("div");this.setStyleForElement(newDivLine,"AutoCompleteDiv");newDivLine.setAttribute("blocnumber",num);newContainer=newDivLine;var newSpan=document.createElement("span");var chaineAff=((this.maxNbChar>0&&liste[0][f].length>this.maxNbChar)?liste[0][f].substring(0,this.maxNbChar)+'&hellip;':liste[0][f]);newSpan.innerHTML=getBoldInv(chaineAff,this._currentInputFieldValue,this.clearAccents,this.clearSpecialChars,this.specialCharExpr);newSpan.setAttribute('valeur',liste[0][f]);if(this._useDirectLinks&&(liste['Link'])&&(liste['Link'][f])){this.setStyleForElement(newSpan,"AutoCompleteDivCol1Anchor")}else{this.setStyleForElement(newSpan,"AutoCompleteDivCol1")}newDivLine.appendChild(newSpan);if(this._use2ndColumn){if((liste[1])&&(liste[1][f]))this.display2ndColumn(newDivLine,liste[1][f]);else this.display2ndColumn(newDivLine,"&nbsp;")}if(this._useId){if(this._use2ndColumn&&(liste[2])&&(liste[2][f]))this.displayId(newDivLine,liste[2][f]);else if(!this._use2ndColumn&&(liste[1][f]))this.displayId(newDivLine,liste[1][f])}this._completeDiv.appendChild(newDivLine);newDivLine.onmousedown=function(event){divOnMouseDownV2(completeur,event,this)};newDivLine.onmousemove=function(event){divOnMouseMoveV2(completeur,event,this)};newDivLine.onmouseout=function(event){divOnMouseOutV2(completeur,event,this)};if(this._useDirectLinks&&(liste['Link'])&&(liste['Link'][f])){newDivLine.setAttribute("href",liste['Link'][f]);var newPicAnchor=document.createElement("UL");this.setStyleForElement(newPicAnchor,"AutoCompleteAnchor");newDivLine.insertBefore(newPicAnchor,newSpan)}this._completeDiv.appendChild(newDivLine)}}if(this._selectElementToHide)hideSelectElementCompletion(this._selectElementToHide);this.PressAction()}else{this.hideCompleteDiv();this._completeDivRows=0}}function handleCursorUpDownEnter(eventCode){if(eventCode==40){this.highlightNewValue(this._highlightedSuggestionIndex+1);return false}else if(eventCode==38){this.highlightNewValue(this._highlightedSuggestionIndex-1);return false}else if(eventCode==13||eventCode==3){return false}this._suggestionUsed=null;return true}function PressAction(){var suggestionList=this._completeDiv.getElementsByTagName("div");var suggestionLongueur=suggestionList.length;this._completeDivRows=suggestionLongueur;this._completeDivDivList=suggestionList;if(this._currentInputFieldValue==""||suggestionLongueur==0)this.hideCompleteDiv();else this.showCompleteDiv();for(var i=0;i<suggestionLongueur;i++){this.setStyleForElement(suggestionList.item(i),"AutoCompleteDiv")}this._highlightedSuggestionIndex=-1;this._highlightedSuggestionDiv=null;var supprSelection=false;switch(this._eventKeycode){case 8:case 33:case 34:case 35:case 35:case 36:case 37:case 39:case 45:case 46:supprSelection=true;break;default:break}if(!supprSelection&&this._highlightedSuggestionDiv){this.setStyleForElement(this._highlightedSuggestionDiv,"AutoCompleteDivAct");var z=this._currentInputFieldValue}else{this._highlightedSuggestionIndex=-1}}function blurThenGetFocus(completeur){this._cursorUpDownPressed=true;this.field.blur();var _self=this;setTimeout(function(){_self.field.focus();if(_self.field.value){oldValue=_self.field.value;_self.field.value="";_self.field.value=oldValue}},10);return}function hideCompleteDiv(){this._completeDiv.style.visibility="hidden";if(this.autoDivCompletion){this._completeDiv.style.position="absolute"}this._completeDiv.style.height="0";this._highlightedSuggestionIndex=-1;if(this._selectElementToHide)showSelectElementCompletion(this._selectElementToHide)}function showCompleteDiv(){if(this.autoDivCompletion){this._completeDiv.style.position="relative"}this._completeDiv.style.height="auto";this._completeDiv.style.visibility="visible"}function highlightNewValue(C){if(!this._completeDivDivList||(this._completeDivRows<=0))return;this.showCompleteDiv();this._suggestionUsed=true;this.setStyleForElement(this._highlightedSuggestionDiv,"AutoCompleteDiv");if(C>=this._completeDivRows){C=-1;this.field.value=this._currentInputFieldValue}else if(C==-1){this.field.value=this._currentInputFieldValue}else if(C<-1){C=this._completeDivRows-1}this._highlightedSuggestionIndex=C;this._highlightedSuggestionDiv=this._completeDivDivList.item(C);if(this._highlightedSuggestionDiv!=null){this.setStyleForElement(this._highlightedSuggestionDiv,"AutoCompleteDivAct");this.field.value=getSuggestionV2(this._highlightedSuggestionDiv,0);if(this.field.completeur._idField!=null&&document.getElementById(this.field.completeur._idField)){document.getElementById(this.field.completeur._idField).value=getSuggestionV2(this._highlightedSuggestionDiv,1)}this.affectValues(this._highlightedSuggestionDiv);this._completeDiv.scrollTop=C*this._highlightedSuggestionDiv.offsetHeight}}function affectValues(theDiv){if(this._use2ndColumn)this._2ndColumnValue=getSuggestionV2(theDiv,1);if(this._useId){if(this._use2ndColumn)this._idValue=getSuggestionV2(theDiv,2);else this._idValue=getSuggestionV2(theDiv,1)}anchor=theDiv.getAttribute('href');if(anchor!=null&&typeof anchor!='undefined'&&anchor.length!=0){this._directLink=anchor}else{this._directLink=""}blocnumber=theDiv.getAttribute('blocnumber');if(blocnumber!=null&&typeof blocnumber!='undefined'){this._blocnumber=blocnumber}else{this._blocnumber=-1}}function display2ndColumn(newDiv,element){var newSpan=document.createElement("SPAN");newSpan.innerHTML=element;newSpan.setAttribute('valeur',element);this.setStyleForElement(newSpan,"AutoCompleteDivCol2");newDiv.appendChild(newSpan);return false}function handle2ndColumn(liste){var optionsCol2=new Array();var options2=liste;if((liste)&&(liste.length)){for(var i=0;i<liste.length;++i){optionsCol2.push(liste[i])}return optionsCol2}return false}function displayId(newDiv,element){var newSpan=document.createElement("SPAN");newSpan.innerHTML=element;newSpan.setAttribute('valeur',element);this.setStyleForElement(newSpan,"AutoCompleteId");newDiv.appendChild(newSpan);return false}function displayHistory(){cookieHistory=handleCookieData(this._cookieName,this.field.value);if(cookieHistory.length>0){var historyDiv=document.createElement("SPAN");historyDiv.innerHTML='Historique&nbsp;(<a href="#" class="AutoCompleteDivDel" onClick="javascript:deleteCookie(\''+this._cookieName+'\',\''+this._completeDiv.id+'\',\''+this.field.id+'\');return false; ">effacer</a>)';historyDiv.id='completeDivTitle';this.setStyleForElement(historyDiv,"AutoCompleteDivTitle");this._completeDiv.appendChild(historyDiv);var completeur=this;for(var f=0;f<cookieHistory.length;f++){var nouveauDiv=document.createElement("DIV");nouveauDiv.onmousedown=function(event){divOnMouseDownV2(completeur,event,this)};nouveauDiv.onmousemove=function(event){divOnMouseMoveV2(completeur,event,this)};nouveauDiv.onmouseout=function(event){divOnMouseOutV2(completeur,event,this)};this.setStyleForElement(nouveauDiv,"AutoCompleteDiv");var nouveauSpan=document.createElement("SPAN");nouveauSpan.innerHTML=cookieHistory[f][0];this.setStyleForElement(nouveauSpan,"AutoCompleteDivCol1");nouveauDiv.appendChild(nouveauSpan);if(this._use2ndColumn){if((cookieHistory[f])&&(cookieHistory[f][1]))this.display2ndColumn(nouveauDiv,cookieHistory[f][1]);else this.display2ndColumn(nouveauDiv,"&nbsp;")}this._completeDiv.appendChild(nouveauDiv)}}}this.completionUsed=completionUsed;this.cmpl=cmpl;this.setStyleForElement=setStyleForElement;this.handleJsonSuggestions=handleJsonSuggestions;this.displayComplete=displayComplete;this.handleCursorUpDownEnter=handleCursorUpDownEnter;this.PressAction=PressAction;this.blurThenGetFocus=blurThenGetFocus;this.hideCompleteDiv=hideCompleteDiv;this.showCompleteDiv=showCompleteDiv;this.highlightNewValue=highlightNewValue;this.affectValues=affectValues;this.display2ndColumn=display2ndColumn;this.handle2ndColumn=handle2ndColumn;this.displayId=displayId;this.displayHistory=displayHistory;this.cacheResults=cacheResults;this.hideCompleteDiv()}completionComponent.count=0;function array_key_exists(key,search){if(!search||(search.constructor!==Array&&search.constructor!==Object)){return false}return search[key]!==undefined}function writeScript(url){var head=document.getElementsByTagName('head')[0];var script=document.createElement('script');if(document.getElementById('scrComp')){var oldSrc=document.getElementById('scrComp');head.removeChild(oldSrc);script.setAttribute('id','scrComp');script.setAttribute('type','text/javascript');script.setAttribute('src',url);head.appendChild(script)}else{script.setAttribute('id','scrComp');script.setAttribute('type','text/javascript');script.setAttribute('src',url);head.appendChild(script)}}function removeAutoComplete(field){field.onkeyup=null}function hideSelectElementCompletion(divId){var nods=document.getElementById(divId).getElementsByTagName('select');for(i=0;i<nods.length;i++){nods[i].style.visibility='hidden';nods[i].cptHideDivAction=0}}function showSelectElementCompletion(divId){var nods=document.getElementById(divId).getElementsByTagName('select');for(i=0;i<nods.length;i++){if(nods[i].cptHideDivAction==0){nods[i].style.visibility='visible'}nods[i].cptHideDivAction=1}}function cursorAfterValue(n){if(n.value){oldValue=n.value;n.value="";n.value=oldValue}}function getSuggestionV2(uneDiv,col){if((!uneDiv)||(!uneDiv.getElementsByTagName)||(!(uneDiv.getElementsByTagName('span')[col])))return null;return uneDiv.getElementsByTagName('span')[col].getAttribute('valeur')}function gaddEvent(obj,evenement,fn){if(obj.addEventListener)obj.addEventListener(evenement,fn,false)else if(obj.attachEvent)obj.attachEvent("on"+evenement,fn)else return false}function divOnMouseDownV2(completeur,event,laDiv){blocnumber=laDiv.getAttribute('blocnumber');checkCallBackFunc=false;if(blocnumber>=0&&typeof completeur.blocksCallBackFunctions!='undefined'&&typeof completeur.blocksCallBackFunctions[blocnumber]!='undefined'){checkCallBackFunc=true}anchor=laDiv.getAttribute('href');if((!checkCallBackFunc||completeur.blocksCallBackFunctions[blocnumber]==null)&&anchor!=null&&typeof anchor!='undefined'){document.location=anchor;event.cancelBubble=true;return}completeur.field.value=getSuggestionV2(laDiv,0);if(completeur.field.completeur._idField!=null&&document.getElementById(completeur.field.completeur._idField)){document.getElementById(completeur.field.completeur._idField).value=getSuggestionV2(laDiv,1)}completeur.affectValues(laDiv);completeur._suggestionUsed=true;if(completeur._useHistory==true){var cookieValue=completeur.field.value;if(completeur._use2ndColumn==true){cookieValue+='|'+getSuggestionV2(laDiv,1)}updateCookie(cookieValue,completeur._cookieName)}completeur.hideCompleteDiv();completeur.blurThenGetFocus();completeur._completeDiv.innerHTML='';if(completeur._launchSearch){if(checkCallBackFunc){if(completeur.blocksCallBackFunctions[blocnumber]==null){if(!completeur._onSubmitFunction){completeur._onSubmitFunction=completeur.field.form.submit}}else if(completeur.blocksCallBackFunctions[blocnumber]=='none'){completeur._onSubmitFunction=completeur.field.form.submit}else{completeur._onSubmitFunction=completeur.blocksCallBackFunctions[blocnumber]}}else if(!completeur._onSubmitFunction){completeur._onSubmitFunction=completeur.field.form.submit}if(completeur._onSubmitFunction){if(anchor!=null&&typeof anchor!='undefined'&&anchor.length!=0){if(completeur.changeFormActionWithLink){completeur.field.form.action=anchor}chaineAppel=completeur._onSubmitFunction+'("'+escape(completeur.field.value)+'","'+completeur._2ndColumnValue+'","'+completeur._idValue+'","'+completeur.field.id+'","'+anchor+'")'}else{chaineAppel=completeur._onSubmitFunction+'("'+escape(completeur.field.value)+'","'+completeur._2ndColumnValue+'","'+completeur._idValue+'","'+completeur.field.id+'")'}eval(chaineAppel)}}}function divOnMouseMoveV2(completeur,event,laDiv){completeur._cursorUpDownPressed=false;if(completeur._highlightedSuggestionDiv){completeur.setStyleForElement(completeur._highlightedSuggestionDiv,"AutoCompleteDiv")}children=laDiv.parentNode.childNodes;for(i=0;i<children.length;i++){if(laDiv==children[i]){completeur._highlightedSuggestionIndex=i-1;completeur._highlightedSuggestionDiv=laDiv;break}}completeur.setStyleForElement(laDiv,"AutoCompleteDivAct");if(completeur.changeOnMouseOver){completeur._suggestionUsed=true;completeur.field.value=getSuggestionV2(laDiv,0);if(completeur.field.completeur._idField!=null&&document.getElementById(completeur.field.completeur._idField)){document.getElementById(completeur.field.completeur._idField).value=getSuggestionV2(laDiv,1)}completeur.affectValues(laDiv)}}function divOnMouseOutV2(completeur,event,laDiv){completeur.setStyleForElement(laDiv,"AutoCompleteDiv");if(completeur.field.completeur._idField!=null&&document.getElementById(completeur.field.completeur._idField)){document.getElementById(completeur.field.completeur._idField).value=getSuggestionV2(this,1)}}var _maxHistoryItemNb=5;function itemInCookie(itemInfos,_cookieName){var cookie=greadCookie(_cookieName);if(cookie!=null){cookie=unescape(cookie);cookie=cookie.split("$");for(j=0;j<cookie.length;j++){if(itemInfos==cookie[j]){return true}}}return false}function handleCookieData(_cookieName,_inputFieldValue){var cookie=greadCookie(_cookieName);var historyList=new Array();if(cookie!=null){cookie=unescape(cookie);cookie=cookie.split("$");for(i=0;i<cookie.length;i+=2){var currentValue=cookie[i].split("|");historyList.push(currentValue)}}return historyList}function greadCookie(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var begin=0;while(begin<clen){var end=begin+alen;if(document.cookie.substring(begin,end)==arg){var endstr=document.cookie.indexOf(";",end);if(endstr==-1)endstr=document.cookie.length;return unescape(document.cookie.substring(end,endstr))}begin=document.cookie.indexOf(" ",begin)+1;if(begin==0)break}return null}function deleteCookie(_cookieName,_completeDivId,_inputField){document.cookie=_cookieName+"=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT";document.getElementById(_completeDivId).innerHTML='';document.getElementById(_inputField).focus();return false}function updateCookie(suggestSel,_cookieName){if(!itemInCookie(suggestSel,_cookieName)){suggestNoAccent=noAccentCmpl(suggestSel);var newCookieValue=escape(suggestSel);newCookieValue+="$"+escape(suggestNoAccent);var oldCookieValue=greadCookie(_cookieName);if(oldCookieValue!=null){oldCookieValue=unescape(oldCookieValue);oldCookieValue=oldCookieValue.split("$");for(i=1;i<=oldCookieValue.length;i+=2){if(i<=_maxHistoryItemNb+2||_maxHistoryItemNb==0)newCookieValue+="$"+oldCookieValue[i-1]+"$"+oldCookieValue[i]}}document.cookie=_cookieName+"="+escape(newCookieValue)+";path=/"}}function noAccentCmpl(str){var a="\xE0\xE2\xE4\xE1\xC0\xC1\xC4\xC2\xEB\xE8\xE9\xEA\xCA\xC9\xC8\xCB\xEF\xEE\xED\xEC\xCC\xCD\xCE\xCF\xF2\xF3\xF4\xF6\xD2\xD3\xD4\xD6\xFC\xF9\xFB\xFA\xDA\xD9\xDB\xDC\xE3\xF5\xF1\xC3\xD5\xD1\xE7";var b="aaaaAAAAeeeeEEEEiiiiIIIIooooOOOOuuuuUUUUaonAONc";for(var i=0;i<a.length;i++){str=str.split(a.charAt(i)).join(b.charAt(i))}return str}function noSpecialCmpl(str,specialCharExpr){var a=str.toLowerCase();var b=a.replace(specialCharExpr,' ');var c=b.replace(/[ ]+/g,' ');var d=c.replace(/^ /,'');var e=d.replace(/ $/,'');return e}function getBoldInv(str,patt,clearAccents,clearSpecialChars,specialCharExpr){newstr="";if(clearAccents){patt=noAccentCmpl(patt)}if(clearSpecialChars){patt=noSpecialCmpl(patt,specialCharExpr)}i=str.indexOf(patt);if(i==-1){patt=noSpecialCmpl(patt,/[^ a-z0-9]/gi);j=str.indexOf(patt);if(j==-1){newstr="<b>"+str+"</b>"}else{newstr="<b>"+newstr+str.substring(0,j)+"</b>"+patt;deb=j+patt.length;if(deb<str.length){newstr=newstr+"<b>"+str.substring(deb)+"</b>"}}}else{newstr="<b>"+newstr+str.substring(0,i)+"</b>"+patt;deb=i+patt.length;if(deb<str.length){newstr=newstr+"<b>"+str.substring(deb)+"</b>"}}return newstr}var BLAutocompleter=completionComponent}var refGstat="";function Cartouche(bhv){if(bhv!==null)var bhv=bhv;else var bhv='shopping';var url_enville,url_moteur,url_shopping,url_plus;this.setBhv=function(bhv_value){bhv=bhv_value}this.getBhv=function(){return bhv}this.setUrlEnville=function(url){url_enville=url}this.setUrlMoteur=function(url){url_moteur=url}this.getUrlMoteur=function(url){return url_moteur}this.setUrlShopping=function(url){url_shopping=url}this.setUrlPlus=function(url){url_plus=url}this.initSearch=function(bhv,team){switch(team){case'rns':switch(bhv){case'searchmono':case'home':this.setSearch('searchmono','top','top');break;default:this.selectItem('cmn_l118712','searchmono');this.hideMonoSearch();if(typeof affichageMonForm4ChampsHeader=='function'){affichageMonForm4ChampsHeader(bhv)}break}break;default:this.setSearch(bhv,'top','top');break}}this.setSearch=function(bhv,from,focus){if(from=="")from="top";if(from=='_bottom'&&document.getElementById('cmn_headSearch_bottom')){document.getElementById('cmn_headSearch').rdata.value=document.getElementById('cmn_headSearch_bottom').rdata.value}else if(from=='top'&&document.getElementById('cmn_headSearch_bottom')){document.getElementById('cmn_headSearch_bottom').rdata.value=document.getElementById('cmn_headSearch').rdata.value}switch(bhv){case'actu':case'actu_video':case'actu_image':case'actu_lire':case'site':case'web_fr':case'web_mondial':case'guide':this.selectItem('cmn_lWeb',bhv);this.showMonoSearch('');if(document.completionorangev2)this.initCartoucheCompletion('web');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher dans le web';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher dans le web';break;case'images':this.selectItem('cmn_lImg',bhv);this.showMonoSearch('');if(document.completionorangev2)this.initCartoucheCompletion('images');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher des images';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher des images';break;case'videos_mos':this.selectItem('cmn_lVid',bhv);this.showMonoSearch('');if(document.completionorangev2)this.initCartoucheCompletion('videos');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher des vid&eacute;os';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher des vid&eacute;os';break;case'shopping':this.selectItem('cmn_lShop',bhv);this.showMonoSearch('shop');if(document.completionorangev2)this.initCartoucheCompletion('shopping');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher des produits';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher des produits';break;case'searchmono':this.selectItem('cmn_l118712','searchmono');if(document.completionorangev2)this.initCartoucheCompletion('annu');removeCompletion("");removeCompletion("_bottom");this.showMonoSearch('');break;case'plan':this.selectItem('cmn_plan',bhv);this.showMonoSearch(bhv);if(document.completionorangev2)this.initCartoucheCompletion('plan');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher dans plan';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher dans plan';break;default:this.selectItem('cmn_plan',bhv);this.showMonoSearch(bhv);if(document.completionorangev2)this.initCartoucheCompletion('plan');document.getElementById('cmn_btnHeadForm').title=document.getElementById('cmn_btnHeadForm').alt='rechercher dans plan';if(document.getElementById('cmn_headSearch_bottom'))document.getElementById('cmn_btnHeadForm_bottom').title=document.getElementById('cmn_btnHeadForm_bottom').alt='rechercher dans plan';break}if(focus=='bottom'&&document.getElementById('cmn_rdata_bottom')){document.getElementById('cmn_rdata_bottom').focus()}else if((focus=='top')&&(oInputRdata=document.getElementById('cmn_rdata'))){oInputRdata.focus()}}this.selectItem=function(idOnglet,bhv){if(document.getElementById('cmn_lWeb'))document.getElementById('cmn_lWeb').className="noSelect";if(document.getElementById('cmn_lImg'))document.getElementById('cmn_lImg').className="noSelect";if(document.getElementById('cmn_lVid'))document.getElementById('cmn_lVid').className="noSelect";if(document.getElementById('cmn_lSite'))document.getElementById('cmn_lSite').className="noSelect";if(document.getElementById('cmn_lShop'))document.getElementById('cmn_lShop').className="noSelect";if(document.getElementById('cmn_l118712'))document.getElementById('cmn_l118712').className="noSelect";if(document.getElementById('cmn_plan'))document.getElementById('cmn_plan').className="noSelect";if(document.getElementById('cmn_lWeb_bottom'))document.getElementById('cmn_lWeb_bottom').className="noSelect";if(document.getElementById('cmn_lImg_bottom'))document.getElementById('cmn_lImg_bottom').className="noSelect";if(document.getElementById('cmn_lVid_bottom'))document.getElementById('cmn_lVid_bottom').className="noSelect";if(document.getElementById('cmn_lSite_bottom'))document.getElementById('cmn_lSite_bottom').className="noSelect";if(document.getElementById('cmn_lShop_bottom'))document.getElementById('cmn_lShop_bottom').className="noSelect";if(document.getElementById('cmn_l118712_bottom'))document.getElementById('cmn_l118712_bottom').className="noSelect";if(document.getElementById('cmn_plan_bottom'))document.getElementById('cmn_plan_bottom').className="noSelect";if(document.getElementById(idOnglet)){document.getElementById(idOnglet).className="select";if(document.getElementById(idOnglet+'_bottom')){document.getElementById(idOnglet+'_bottom').className="select"}}else{document.getElementById('cmn_lWeb').className="select";if(document.getElementById('cmn_lWeb_bottom'))document.getElementById('cmn_lWeb_bottom').className="select"}document.getElementById('cmn_bhv').value=bhv}this.initCartoucheCompletion=function(type){usedOld=false;if(typeof(BLO_Autocompletion)!="undefined"){usedOld=BLO_Autocompletion.completionUsed()}keCmplUrl="";switch(type){case'web':keCmplUrl=((typeof hostcompletion!='undefined'&&hostcompletion)?hostcompletion:'')+"/fr/completion/xml/fullxml?id=-1,10&an1=8&an2=2&version=2";refGstat="Oshopping_Cartouche_Web";break;case'images':keCmplUrl=((typeof hostcompletion!='undefined'&&hostcompletion)?hostcompletion:'')+"/fr/completion/xml/fullxml?id=1&version=2";refGstat="Oshopping_Cartouche_Images";break;case'videos':keCmplUrl=((typeof hostcompletion!='undefined'&&hostcompletion)?hostcompletion:'')+"/fr/cmplvideo/xml/fullxml?id=1&version=2";refGstat="Oshopping_Cartouche_Videos";break;case'shopping':keCmplUrl=((typeof hostcompletion!='undefined'&&hostcompletion)?hostcompletion:'')+"/fr/completion/xml/fullxml?id=2";refGstat="Oshopping_Cartouche_Shopping";break;case'annu':refGstat="Oshopping_Cartouche_Annu";break;case'plan':keCmplUrl="";break;default:refGstat="Oshopping_Cartouche_undefType";break}if(appliKeweb==false){removeCompletion("");if(keCmplUrl!=""){prepareCompletion(keCmplUrl,"",type)}else{prepareCompletion(keCmplUrl,"",type)}if(typeof(BLO_Autocompletion)!="undefined"){BLO_Autocompletion._launchSearch=true;BLO_Autocompletion.used=usedOld}}}this.formSubmit=function(pos){if(BLO_Autocompletion.typeComponent=="plan")return false;else{var bhv=document.getElementById('cmn_bhv').value;if(bhv=='shopping'){return this.validateShopping(pos)}else if((bhv=="searchinv")||(bhv=="searchpar")||(bhv=="searchspa")||(bhv=="searchproxi")||(bhv=="home")||(bhv=="searchmono")){return this.validateEnvilleMonochamp('enville',bhv,pos)}else{var sSearch=encodeURIComponent(document.getElementById('cmn_rdata'+pos).value);var requete='';var profil=document.getElementById('cmn_profil'+pos).value;if((profil=="")||(profil=="undefined")||(profil=="enville")||(profil=="orange_enville")||(profil=="118712"))requete+="&profil=orange";else requete+="&profil="+profil;if(bhv!="")requete+="&bhv="+bhv;if((document.getElementById('cmn_alt'+pos).value!="")&&((bhv=="site")||(bhv=="web_fr")))requete+="&alt="+document.getElementById('cmn_alt'+pos).value;var sOpenURL=url_moteur+"?rdata="+sSearch+requete;if(sSearch!=''){if((typeof(BLO_Autocompletion)!="undefined")&&((BLO_Autocompletion.used||BLO_Autocompletion.completionUsed())&&refGstat)){refGstat+='_withSugg'}sOpenURL=getGStatUrlJS(refGstat,sOpenURL);self.document.location.href=sOpenURL}}}return false}this.validateShopping=function(pos){if((pos=="top")||(!pos))pos="";searchform=document.getElementById('cmn_headSearch'+pos);searchform.rdata.value=escapePlus(trim(searchform.rdata.value));if(searchform.rdata.value.length>0){searchform.action=url_shopping;var EscapedRdata=encodeURI(searchform.rdata.value);if(url_shopping=="http://search.ke.voila.fr/S/orange"){var sFinalUrl=url_shopping+"?rdata="+EscapedRdata}else{var sFinalUrl=url_shopping+"prix-"+EscapedRdata}searchform.Cat.value=trim(searchform.Cat.value)var EscapedCatid=escape(searchform.Cat.value);var refCat='';if(searchform.Cat.value.length>0){sFinalUrl+='/cat_'+EscapedCatid;refCat='_'+EscapedCatid}if((typeof(BLO_Autocompletion)!="undefined")&&((BLO_Autocompletion.used||BLO_Autocompletion.completionUsed())&&refGstat)){refGstat+='_withSugg'}refGstat+='_'+EscapedRdata+refCat;sFinalUrl=getGStatUrlJS(refGstat,sFinalUrl);self.document.location.href=sFinalUrl}return false}this.validateEnvilleMonochamp=function(profil,bhv,pos){if(searchform=document.getElementById('cmn_headSearch'+pos)){searchform.name.value=searchform.rdata.value;searchform.rdata.value=trim(searchform.rdata.value);if(searchform.rdata.value!=''){ref=refGstat+'_'+escape(searchform.rdata.value);trackGstatXhr(ref);searchform.profil.value=profil;searchform.bhv.value=bhv;searchform.action=url_enville;searchform.method='post';searchform.target='_top';searchform.submit()}}return false}this.showMonoSearch=function(type){var classInput,classList,oInput;switch(type){case'shop':classInput='searchTxt';classList='hide';break;case"plan":if(oInput=document.getElementById('cmn_rdata')){if(oInput.attachEvent)oInput.attachEvent("onkeydown",searchAddressKeyPress);else if(oInput.addEventListener)oInput.addEventListener("keydown",searchAddressKeyPress,false)}classInput='searchTxt header-search-input';classList='hide';break;default:classInput='searchTxt';classList='hide';break}if(oInput=document.getElementById('cmn_rdata'))oInput.className=classInput;if(oInput=document.getElementById('cmn_rdata_bottom'))oInput.className=classInput;var oDivCatLink;if(oDivCatLink=document.getElementById('catShopping'))oDivCatLink.className=classList;if(oDivCatLink=document.getElementById('catShopping_bottom'))oDivCatLink.className=classList;var oDivCatList;if(oDivCatList=document.getElementById('wgCatList'))oDivCatList.className='wgCatList hide';if(oDivCatList=document.getElementById('wgCatList_bottom'))oDivCatList.className='wgCatList hide'}this.hideMonoSearch=function(){if(document.getElementById('cmn_divFormOrange')&&document.getElementById('cmn_divFormOrange').style.display=="block"){document.getElementById('cmn_divFormOrange').style.display="none"}}this.setRdata=function(txt){document.getElementById('cmn_rdata').value=trim(txt);document.getElementById('cmn_name').value=trim(txt)}}function prepareCompletion(url,pos,type){var pos="";var divCompletion=document.getElementById('cmn_autoComp_reskeCmpl'+pos);var onSubmitFunction='BLO_AutocompletionOnSelectEntry';var paramName='kw';var defaultParams='dtd=2.0&cbf=BLO_Autocompletion'+pos+'.cmpl';var cssPrefix="cartWeb";var selectToHide=null;var idField=null;var left=-2;var width="";var typeComponent=type;if(type=="plan"){var field=document.getElementById('cmn_btnHeadForm'+pos)}else{var field=document.getElementById('cmn_rdata'+pos);divCompletion.style.visibility="visible";if(document.getElementById("header-search-ambiguity-box"))document.getElementById("header-search-ambiguity-box").style.display="hidden"}var BLO_AutocompletionLocale=new completionComponent(divCompletion,field,onSubmitFunction,url,paramName,defaultParams,cssPrefix,selectToHide,idField,left,width,type);BLO_AutocompletionLocale.onMouseOverUpdate=false;BLO_AutocompletionLocale._launchSearch=true;BLO_AutocompletionLocale.blocksTitlesList=['suggestions','sur Orange'];BLO_AutocompletionLocale.blocksConditionList=['ID==1','ID==2'];BLO_AutocompletionLocale.blocksCountList=[8,2];BLO_AutocompletionLocale._use2ndColumn=true;BLO_AutocompletionLocale._useDirectLinks=true;BLO_AutocompletionLocale._useHistory=false;BLO_AutocompletionLocale._maxHistoryItemNb=4;BLO_AutocompletionOnSelectEntry=function(){if((BLO_AutocompletionLocale._launchSearch==true)&&(typeof(cartouche)!='undefined')){cartouche.formSubmit()}}if(pos=="")BLO_Autocompletion=BLO_AutocompletionLocale;else BLO_Autocompletion_bottom=BLO_AutocompletionLocale}function removeCompletion(pos){if(typeof BLO_Autocompletion!="undefined")removeAutoComplete(document.getElementById('cmn_rdata'));return false}function trim(string){return string.replace(/(^\s*)|(\s*$)/g,'')}function getGStatUrlJS(ref,url){server='http://r.orange.fr/r';gstat_url=server+'?ref='+ref+'&url='+encodeURIComponent(url);return gstat_url}function trackGstatXhr(ref){imgTrackerUrl='http://r.orange.fr/r?ref='+ref+'&url='+escape('http://'+window.location.hostname+'/I/gStat.gif');try{var xhr;xhr=getXhrValider();if(xhr!=false){xhr.open("GET","/php/wg_tracker.php?url="+escape(imgTrackerUrl),true);xhr.send(null)}}catch(e){}}window.shopRdata=null;window.shopCat=null;var urlLrShopping='';switch(window.location.hostname){case'shopping.orange.fr':urlLrShopping="http://r.orange.fr/r/Oshopping_search";window.onerror=hideNaggingErrors;break;default:urlLrShopping="http://shopping.orange.fr/";break}function hideNaggingErrors(msg,url,line){var expr1=/location\.href$/i;var expr2=/location\.tostring$/i;if(expr1.test(msg)||expr2.test(msg)){return true}}var appliKeweb=false;var hostcompletion="http://completion.ke.voila.fr";var cartouche=new Cartouche('plan');cartouche.setUrlMoteur('http://search.ke.voila.fr/S/orange');cartouche.setUrlEnville('http://www.118712.orange.fr/S/searchproxi');cartouche.setUrlPlus('http://r.orange.fr/r?ref=O_LR_plus&amp;url=http%3A//plus.ke.orange.fr');if((typeof(BLO_Autocompletion)!="undefined")&&(BLO_Autocompletion.used||BLO_Autocompletion.completionUsed())){cartouche.setUrlShopping('http://r.orange.fr/r?ref='+refGstat+'&url='+escape(urlLrShopping))}else{cartouche.setUrlShopping(urlLrShopping)}function getParametre_querystring(lQuery,lDoc){var lSignet="";var n1=lDoc.indexOf("?");if(n1>0){var n2=lDoc.indexOf("?"+lQuery+"=",n1);if(n2<n1)n2=lDoc.indexOf("&"+lQuery+"=",n1);if(n2>=n1){n2=n2+("?"+lQuery+"=").length;var n3=lDoc.indexOf("&",n2);if(n3>=n2)lSignet=lDoc.substring(n2,n3);else lSignet=lDoc.substring(n2)}}return lSignet}function remplace(expr,a,b){var i=0;while(i!=-1){i=expr.indexOf(a,i);if(i>=0){expr=expr.substring(0,i)+b+expr.substring(i+a.length);i+=b.length}}return expr}function escapePlus(string){var plusEscape="%"+"+".charCodeAt(0).toString(16).toUpperCase();string=string.replace('+',plusEscape);string=string.replace(/\s+/,' ');string=string.replace(/^ /,'');string=string.replace(/ $/,'');return(string)}function shopOnglets(pos){var htmlO='  <div class="onglet hide">';htmlO+='   <ul>';htmlO+='    <li class="noSelect" id="cmn_lWeb'+pos+'">';htmlO+='     <div class="v3web">';htmlO+='      <label for="cmn_rdata'+pos+'">';htmlO+='       <a title="rechercher dans le web" onkeypress="if (event.keyCode != 9){cartouche.setSearch(\'web_fr\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');}" onclick="cartouche.setSearch(\'web_fr\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');" href="#">web</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='    <li class="noSelect" id="cmn_lImg'+pos+'">';htmlO+='     <div class="v3image">';htmlO+='      <label for="cmn_rdata'+pos+'">';htmlO+='       <a title="rechercher des images" onkeypress="if (event.keyCode != 9){cartouche.setSearch(\'images\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');}" onclick="cartouche.setSearch(\'images\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');" href="#">images</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='    <li class="noSelect" id="cmn_lVid'+pos+'">';htmlO+='     <div class="v3video">';htmlO+='      <label for="cmn_rdata'+pos+'">';htmlO+='       <a title="rechercher des vid&eacute;os" onkeypress="if (event.keyCode != 9){cartouche.setSearch(\'videos_mos\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');}" onclick="cartouche.setSearch(\'videos_mos\',\''+pos+'\',\''+pos+'\');return cartouche.formSubmit(\''+pos+'\');" href="#">vid&eacute;os</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='    <li class="noSelect" id="cmn_lShop'+pos+'">';htmlO+='     <div class="v3shop">';htmlO+='      <label for="cmn_rdata'+pos+'">';htmlO+='       <a title="rechercher des produits" onkeypress="if (event.keyCode != 9){cartouche.setSearch(\'shopping\',\''+pos+'\',\''+pos+'\');return cartouche.validateShopping();}" onclick="cartouche.setSearch(\'shopping\',\''+pos+'\',\''+pos+'\');return cartouche.validateShopping();" href="#">shopping</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='     <li class="noSelect" id="cmn_l118712'+pos+'">';htmlO+='     <div class="v3annuaire">';htmlO+='      <label>';htmlO+='       <a onkeypress="if (event.keyCode != 9){cartouche.setSearch(\'searchmono\',\''+pos+'\',\''+pos+'\');return cartouche.validateEnvilleMonochamp(\'enville\',\'searchmono\');}" onclick="cartouche.setSearch(\'searchmono\',\''+pos+'\',\''+pos+'\');return cartouche.validateEnvilleMonochamp(\'enville\',\'searchmono\');" href="#" title="rechercher un professionnel ou un particulier" >annuaire</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='     <li class="select" id="cmn_plan'+pos+'">';htmlO+='     <div class="v3plan">';htmlO+='      <label>';htmlO+='       <a onkeypress="if (event.keyCode != 9)cartouche.setSearch(\'plan\',\''+pos+'\',\''+pos+'\');" onclick="cartouche.setSearch(\'plan\',\''+pos+'\',\''+pos+'\');return false;" href="#" title="rechercher un professionnel ou un particulier sur un plan" >plan</a>';htmlO+='      </label>';htmlO+='     </div>';htmlO+='    </li>';htmlO+='    <li class="normalLink noBordure" id="cmn_lOrg'+pos+'">';htmlO+='     <a title="tous les services de recherche" href="http://r.orange.fr/r?ref=O_LR_plus&amp;url=http%3A//plus.ke.orange.fr" class="normal_plus">plus ...</a>';htmlO+='    </li>';htmlO+='   </ul>';htmlO+='  </div>';return htmlO}function planSearch(pos){var htmlS='';htmlS+='  <div class="cmn_divFormOrange" id="cmn_divFormOrange'+pos+'">';htmlS+='  <div title="Center la carte sur votre position" onclick="geolocalizeUser()" id="geolocalize"></div>';htmlS+='   <form onsubmit="return cartouche.formSubmit(\''+pos+'\');" target="" method="get" action="" class="formSearch" id="cmn_headSearch'+pos+'" autocomplete="off">';htmlS+='    <input type="hidden" value="shopping" name="bhv" id="cmn_bhv'+pos+'">';htmlS+='    <input type="hidden" value="orange'+(detectFibre()?"_lafibre":"")+'" name="profil" id="cmn_profil'+pos+'">';htmlS+='    <input type="hidden" value="kw" name="rtype" id="cmn_rtype'+pos+'">';htmlS+='    <input type="hidden" value="1" name="ap" id="cmn_ap'+pos+'">';htmlS+='    <input type="hidden" value="" name="alt" id="cmn_alt'+pos+'">';htmlS+='    <input type="hidden" value="" name="name" id="cmn_name'+pos+'">';htmlS+='    <input type="hidden" value="" name="Cat" id="cmn_Cat'+pos+'">';htmlS+='    <div class="divRdata header-search-result-box">';htmlS+='     <div class="champNorm">        ';htmlS+='<label id="info_label" for="cmn_rdata">une adresse, un code postal, une ville ...</label>';htmlS+='      <input type="text" class="searchTxtMini" value="" accesskey="0" autocomplete="off" name="rdata" id="cmn_rdata'+pos+'" onblur="if(document.getElementById(\'cmn_rdata\').value==\'\')o_displayInfoLabel();" onfocus="o_MasquerInfoLabel()">';htmlS+='      <input type="submit" value="" class="searchBtn_buttonOut" title="rechercher dans le web" onmouseover="this.className=\'searchBtn_buttonOver\'" onfocus="this.className=\'searchBtn_buttonOver\'" onsubmit="return false;" onmouseout="this.className=\'searchBtn_buttonOut\'" onclick="o_MasquerInfoLabel();o_getPlanFocus(\'cmn_rdata'+pos+'\');" onblur="this.className=\'searchBtn_buttonOut\'" id="cmn_btnHeadForm'+pos+'">';htmlS+='     </div>';htmlS+='    </div>';htmlS+='   </form>';htmlS+='  </div>';return htmlS}function o_displayInfoLabel(){o_hGetById("info_label").style.display="block"}function o_MasquerInfoLabel(){o_hGetById("info_label").style.display="none"}function o_getPlanFocus(id){o_hGetById(id).focus()}function detectFibre(){var urlHeader='';if((document.cookie.length>0)&&(document.cookie.indexOf("oHPFibre=")!=-1)){return true}return false}var navig={isIE:(navigator.userAgent.indexOf("MSIE")>-1),isFF:(navigator.userAgent.indexOf("Firefox")>-1),isChrome:(navigator.userAgent.indexOf("Chrome")>-1),isOpera:(window.prop&&window.prop.indexOf("Opera")>-1)||false,isSafari:(navigator.vendor&&navigator.vendor.indexOf("Apple")>-1)||false};function afficher_wg_shopping(){try{var bodyID=document.getElementsByTagName("body")[0];if(document.body){if(window.o_timerWGShop)clearInterval(window.o_timerWGShop);var fibreShopping=false;var sHTML='<div class="moteurLien">';if(fibreShopping){sHTML+='<div id="logo_fibre" class="c_fl_R"> </div>'}sHTML+=' <div class="logo">';sHTML+='<a class="logo" title="retour &agrave; l\'accueil" target="_top" href="http://r.orange.fr/r/Ohome_accueil" ></a>';sHTML+='<span class="o_domain">plan</span>';sHTML+=' </div>';sHTML+=' <div class="formulaire">';var shopO1=shopOnglets("");var shopS1=planSearch("");sHTML+=shopO1;sHTML+=shopS1;sHTML+='</div>';sHTML+='<a class="liens" href="/"></a>';sHTML+='</div>';if(fibreShopping){var urlCssFibre='c.orange.fr/Css/o_headerPortailFibre.css';var cssNode=document.createElement("link");cssNode.setAttribute("rel","stylesheet");cssNode.setAttribute("type","text/css");cssNode.setAttribute("href",document.location.protocol+'//'+urlCssFibre);bodyID.appendChild(cssNode);if(navig.isIE){var urlCssFibreObs='c.orange.fr/Css/o_headerPortailFibreVintage.css';var cssNode2=document.createElement("link");cssNode2.setAttribute("rel","stylesheet");cssNode2.setAttribute("type","text/css");cssNode2.setAttribute("href",document.location.protocol+'//'+urlCssFibreObs);bodyID.appendChild(cssNode2)}}var hNode=document.createElement('div');hNode.setAttribute('id','o_headerPlanID');hNode.className='o_headerPlan'+(fibreShopping?'o_headerShopFibre':'')+' o_r_header';hNode.innerHTML=sHTML;document.body.insertBefore(hNode,bodyID.firstChild);o_confCommon.headerDisplay=true;o_confCommon.dropDownPage=false;o_confCommon.genericHeaderZone=false;o_display_header();if(typeof o_onLoadPush=="function"){}cartouche.initSearch(cartouche.getBhv(),'search')}else{if(typeof window.o_timerWGShop=="undefined")window.o_timerWGShop=setInterval("afficher_wg_shopping()",10)}}catch(e){}}var o_timerWGShop=setInterval("afficher_wg_shopping()",10);